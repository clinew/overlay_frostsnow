From 88ba916190a47cca6d0f182713257b4b94ea6cbc Mon Sep 17 00:00:00 2001
From: Wade Cline <wadecline@hotmail.com>
Date: Sun, 8 May 2022 21:30:13 -0700
Subject: [PATCH 2/9] Fix template files

---
 make/template/inspircd.service | 4 ++--
 make/template/logrotate        | 7 +++++--
 2 files changed, 7 insertions(+), 4 deletions(-)

diff --git a/make/template/inspircd.service b/make/template/inspircd.service
index c92206e0a..7cf420177 100644
--- a/make/template/inspircd.service
+++ b/make/template/inspircd.service
@@ -32,8 +32,8 @@ ExecReload=/bin/kill -HUP $MAINPID
 ExecStart=@BINARY_DIR@/inspircd --nofork --nopid
 Restart=on-failure
 Type=simple
-User=@USER@
-Group=@GROUP@
+User=inspircd
+Group=inspircd
 
 [Install]
 WantedBy=multi-user.target
diff --git a/make/template/logrotate b/make/template/logrotate
index a80d2b5a3..3f4a497c4 100644
--- a/make/template/logrotate
+++ b/make/template/logrotate
@@ -20,7 +20,7 @@
 
 @LOG_DIR@/* {
 	compress
-	create 0644 @USER@ @GROUP@
+	create 0644 inspircd inspircd
 	dateext
 	delaycompress
 	missingok
@@ -28,7 +28,10 @@
 	rotate 8
 	weekly
 	postrotate
-		if [ -d /lib/systemd ]
+		if [ -x /sbin/openrc ]
+		then
+			rc-service inspircd rehash
+		elif [ -d /lib/systemd ]
 		then
 			if systemctl --quiet is-active inspircd
 			then
-- 
2.35.1

